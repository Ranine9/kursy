<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platforma Materiałów Cyfrowych - Witamy!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        html {
            scroll-behavior: smooth;
        }
        .nav-link-active {
            color: #3b82f6; /* Tailwind blue-500 */
            font-weight: 600;
        }
        .btn {
            @apply inline-block px-6 py-3 text-center font-semibold rounded-lg shadow-md transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2;
        }
        .btn-primary {
            @apply bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500;
        }
        .btn-secondary {
            @apply bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400;
        }
        .scroll-animate {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .scroll-animate.appeared {
            opacity: 1;
            transform: translateY(0);
        }
        /* Usunięto style związane z kartami materiałów i loaderem, bo sekcja materiałów została usunięta */
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="index.html" class="text-3xl font-bold text-blue-600">Materiały<span class="text-gray-700">PRO</span></a>

                <nav class="hidden md:flex space-x-6">
                    <a href="#hero" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors nav-link-active">Start</a>
                    <a href="#about" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">O nas</a>
                    <a href="#contact" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Kontakt</a>
                    <a href="/material_gallery.html" id="browse-materials-nav" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Przeglądaj Materiały</a>
                </nav>

                <div class="hidden md:flex items-center space-x-3" id="auth-links">
                    <a href="login.html" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Zaloguj się</a>
                    <a href="register.html" class="btn btn-primary text-sm">Zarejestruj się</a>
                </div>
                <div class="hidden md:flex items-center space-x-3" id="user-greeting" style="display: none;">
                    <span id="username-display" class="text-gray-700 text-sm font-medium"></span>
                    <a href="/dashboard.html" class="text-gray-600 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Panel Użytkownika</a>
                    <button id="logout-button-desktop" class="btn btn-secondary text-sm">Wyloguj</button>
                </div>


                <div class="md:hidden">
                    <button id="mobile-menu-button" class="text-gray-600 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 rounded-md p-2">
                        <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div id="mobile-menu" class="md:hidden hidden bg-white shadow-lg rounded-b-lg">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#hero" class="block text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors">Start</a>
                <a href="/material_gallery.html" id="browse-materials-nav-mobile" class="block text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors">Przeglądaj Materiały</a>
                <a href="#about" class="block text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors">O nas</a>
                <a href="#contact" class="block text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors">Kontakt</a>
            </div>
            <div class="pt-4 pb-3 border-t border-gray-200">
                <div id="mobile-auth-links">
                    <div class="flex items-center px-5">
                        <a href="login.html" class="block w-full text-center text-gray-600 hover:bg-gray-100 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors">Zaloguj się</a>
                    </div>
                    <div class="mt-3 px-2 space-y-1">
                        <a href="register.html" class="block w-full text-center btn btn-primary text-base">Zarejestruj się</a>
                    </div>
                </div>
                <div id="mobile-user-greeting" style="display: none;" class="px-5">
                     <span id="mobile-username-display" class="block text-center text-gray-700 text-base font-medium mb-2"></span>
                     <a href="/dashboard.html" class="block w-full text-center text-gray-600 hover:bg-gray-100 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium transition-colors mb-2">Panel Użytkownika</a>
                     <button id="logout-button-mobile" class="block w-full text-center btn btn-secondary text-base">Wyloguj</button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="hero" class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-20 md:py-32 scroll-animate">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold mb-6 leading-tight">
                    Odkryj Świat Unikalnych Materiałów Cyfrowych!
                </h1>
                <p class="text-lg sm:text-xl md:text-2xl mb-10 max-w-3xl mx-auto text-blue-100">
                    Dołącz do nas, aby uzyskać dostęp do e-booków, poradników, szablonów i innych zasobów przygotowanych przez ekspertów.
                </p>
                <a href="/material_gallery.html" id="browse-materials-hero-btn" class="btn btn-primary text-lg px-8 py-4 transform hover:scale-105">Zacznij Przeglądać Materiały</a>
                <p class="mt-4 text-sm text-blue-200">(Wymagane zalogowanie lub rejestracja)</p>
            </div>
        </section>

        <section id="features" class="py-16 md:py-24 bg-gray-50">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12 md:mb-16 scroll-animate">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gray-800">Dlaczego My?</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">
                        Oferujemy starannie wyselekcjonowane materiały, które pomogą Ci rozwijać umiejętności i osiągać cele.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-10">
                    <div class="bg-white p-8 rounded-xl shadow-lg text-center scroll-animate">
                        <div class="text-blue-600 mb-4">
                            <i class="fas fa-award fa-3x"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Wysoka Jakość</h3>
                        <p class="text-gray-600 text-sm">
                            Każdy materiał jest starannie przygotowany przez ekspertów w swojej dziedzinie.
                        </p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg text-center scroll-animate" style="animation-delay: 0.1s;">
                        <div class="text-blue-600 mb-4">
                            <i class="fas fa-users fa-3x"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Społeczność</h3>
                        <p class="text-gray-600 text-sm">
                            Dołącz do naszej rosnącej społeczności użytkowników i twórców.
                        </p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg text-center scroll-animate" style="animation-delay: 0.2s;">
                        <div class="text-blue-600 mb-4">
                            <i class="fas fa-rocket fa-3x"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Ciągły Rozwój</h3>
                        <p class="text-gray-600 text-sm">
                            Regularnie dodajemy nowe zasoby i aktualizujemy istniejące.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section id="how-it-works" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12 md:mb-16 scroll-animate">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gray-800">Jak To Działa?</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">
                        Prosty proces, aby zacząć korzystać z naszych zasobów.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12 text-center">
                    <div class="scroll-animate">
                        <div class="bg-blue-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 text-2xl font-bold">1</div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Zarejestruj się</h3>
                        <p class="text-gray-600 text-sm">Stwórz darmowe konto w kilka chwil.</p>
                    </div>
                    <div class="scroll-animate" style="animation-delay: 0.1s;">
                        <div class="bg-blue-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 text-2xl font-bold">2</div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Zaloguj się</h3>
                        <p class="text-gray-600 text-sm">Uzyskaj dostęp do pełnej biblioteki materiałów.</p>
                    </div>
                    <div class="scroll-animate" style="animation-delay: 0.2s;">
                        <div class="bg-blue-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 text-2xl font-bold">3</div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">Pobieraj i Ucz się</h3>
                        <p class="text-gray-600 text-sm">Wybieraj materiały i korzystaj z nich bez ograniczeń.</p>
                    </div>
                </div>
                <div class="text-center mt-12 scroll-animate">
                    <a href="register.html" class="btn btn-primary text-lg">Dołącz Teraz</a>
                </div>
            </div>
        </section>


        <section id="about" class="py-16 md:py-24 bg-gray-50"> <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="max-w-3xl mx-auto text-center scroll-animate">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-6">Kim Jesteśmy?</h2>
                    <p class="text-lg text-gray-600 mb-4">
                        Jesteśmy pasjonatami dzielenia się wiedzą i wartościowymi zasobami. Naszą misją jest dostarczanie wysokiej jakości materiałów cyfrowych, które pomagają naszym użytkownikom rozwijać swoje umiejętności, realizować pasje i osiągać cele.
                    </p>
                    <p class="text-lg text-gray-600">
                        Nasz zespół dba o to, aby każdy materiał był starannie przygotowany, aktualny i praktyczny. Dołącz do naszej społeczności i odkryj bogactwo dostępnych zasobów!
                    </p>
                </div>
            </div>
        </section>

        <section id="contact" class="py-16 md:py-24 bg-white"> <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="max-w-xl mx-auto scroll-animate">
                    <h2 class="text-3xl sm:text-4xl font-bold text-gray-800 text-center mb-10">Skontaktuj się z Nami</h2>
                    <form id="contactForm" class="bg-white p-8 rounded-xl shadow-lg space-y-6">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700">Imię i Nazwisko</label>
                            <input type="text" name="name" id="name" autocomplete="name" required
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Adres Email</label>
                            <input type="email" name="email" id="email" autocomplete="email" required
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="subject" class="block text-sm font-medium text-gray-700">Temat</label>
                            <input type="text" name="subject" id="subject" required
                                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="message" class="block text-sm font-medium text-gray-700">Wiadomość</label>
                            <textarea id="message" name="message" rows="4" required
                                      class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></textarea>
                        </div>
                        <div>
                            <button type="submit" class="w-full btn btn-primary py-3">
                                Wyślij Wiadomość
                            </button>
                        </div>
                    </form>
                    <p class="mt-6 text-center text-gray-600 text-sm">
                        Możesz również napisać do nas na <a href="mailto:kontakt@materialypro.pl" class="text-blue-600 hover:underline">kontakt@materialypro.pl</a>
                    </p>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-gray-300 py-12">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-semibold text-white mb-4">MateriałyPRO</h3>
                    <p class="text-sm">Twoje źródło wartościowych materiałów cyfrowych.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Szybkie Linki</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="/material_gallery.html" class="hover:text-blue-400 transition-colors">Wszystkie Materiały</a></li>
                        <li><a href="#about" class="hover:text-blue-400 transition-colors">O Nas</a></li>
                        <li><a href="#contact" class="hover:text-blue-400 transition-colors">Kontakt</a></li>
                        <li><a href="/dashboard.html" id="footer-dashboard-link" class="hover:text-blue-400 transition-colors" style="display:none;">Panel Użytkownika</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-white mb-4">Znajdź Nas</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Facebook">
                            <span class="sr-only">Facebook</span>
                            <i class="fab fa-facebook-f fa-lg"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Instagram">
                            <span class="sr-only">Instagram</span>
                            <i class="fab fa-instagram fa-lg"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors" aria-label="Twitter">
                            <span class="sr-only">Twitter</span>
                            <i class="fab fa-twitter fa-lg"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-700 text-center text-sm">
                <p>&copy; <span id="currentYear"></span> MateriałyPRO. Wszelkie prawa zastrzeżone.</p>
                <p class="mt-1">
                    <a href="#" class="hover:text-blue-400 transition-colors">Polityka Prywatności</a> |
                    <a href="#" class="hover:text-blue-400 transition-colors">Regulamin Usług</a>
                </p>
            </div>
        </div>
    </footer>

    <div id="messageModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-[100] hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md mx-auto">
            <div class="text-center">
                <h3 id="messageModalTitle" class="text-xl font-semibold mb-4 text-gray-800">Komunikat</h3>
                <p id="messageModalText" class="text-gray-600 mb-6"></p>
                <button id="messageModalCloseBtn" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>


    <script>
        // Obsługa menu mobilnego
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                const icon = mobileMenuButton.querySelector('svg');
                if (mobileMenu.classList.contains('hidden')) {
                    icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
                } else {
                    icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
                }
            });

            const mobileNavLinks = mobileMenu.querySelectorAll('a'); // Wszystkie linki w menu mobilnym
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', () => {
                    // Nie zamykaj menu, jeśli to przycisk wylogowania, bo on i tak przekieruje
                    if (!link.id.startsWith('logout-button')) {
                        mobileMenu.classList.add('hidden');
                        mobileMenuButton.querySelector('svg').innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
                    }
                });
            });
        }
        
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Animacja pojawiania się elementów przy przewijaniu
        const scrollElements = document.querySelectorAll('.scroll-animate');
        const elementInView = (el, percentageScroll = 100) => {
            const elementTop = el.getBoundingClientRect().top;
            return (
                elementTop <= (window.innerHeight || document.documentElement.clientHeight) * (percentageScroll / 100)
            );
        };
        const displayScrollElement = (element) => element.classList.add('appeared');
        const handleScrollAnimation = () => {
            scrollElements.forEach((el) => {
                if (elementInView(el, 75)) displayScrollElement(el);
            });
        };
        window.addEventListener('load', handleScrollAnimation); // Uruchom po załadowaniu, aby animować elementy już widoczne
        window.addEventListener('scroll', handleScrollAnimation);


        // Modal
        const messageModal = document.getElementById('messageModal');
        const messageModalTitle = document.getElementById('messageModalTitle');
        const messageModalText = document.getElementById('messageModalText');
        const messageModalCloseBtn = document.getElementById('messageModalCloseBtn');

        function showModal(title, message) {
            if (messageModal && messageModalTitle && messageModalText) {
                messageModalTitle.textContent = title;
                messageModalText.textContent = message;
                messageModal.classList.remove('hidden');
            }
        }

        if (messageModalCloseBtn && messageModal) {
            messageModalCloseBtn.addEventListener('click', () => {
                messageModal.classList.add('hidden');
            });
        }
        
        // Formularz kontaktowy
        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
            contactForm.addEventListener('submit', function(event) {
                event.preventDefault();
                // Tutaj można dodać logikę wysyłki formularza (np. przez fetch do API)
                // Na razie tylko wyświetlamy komunikat
                showModal('Wiadomość Wysłana', 'Dziękujemy za kontakt! Odpowiemy najszybciej jak to możliwe.');
                contactForm.reset(); // Czyści formularz po wysłaniu
            });
        }


        // Logika związana z logowaniem/wylogowaniem i stanem użytkownika
        const authLinks = document.getElementById('auth-links');
        const userGreeting = document.getElementById('user-greeting');
        const usernameDisplay = document.getElementById('username-display');
        const mobileAuthLinks = document.getElementById('mobile-auth-links');
        const mobileUserGreeting = document.getElementById('mobile-user-greeting');
        const mobileUsernameDisplay = document.getElementById('mobile-username-display');
        const logoutButtonDesktop = document.getElementById('logout-button-desktop');
        const logoutButtonMobile = document.getElementById('logout-button-mobile');
        const footerDashboardLink = document.getElementById('footer-dashboard-link');
        const browseMaterialsNav = document.getElementById('browse-materials-nav');
        const browseMaterialsNavMobile = document.getElementById('browse-materials-nav-mobile');
        const browseMaterialsHeroBtn = document.getElementById('browse-materials-hero-btn');


        async function checkUserStatusAndUpdateUI() {
            try {
                const response = await fetch('/api/user', { credentials: 'include' });
                if (response.ok) {
                    const userData = await response.json();
                    if (userData.username) {
                        // Użytkownik zalogowany
                        if (authLinks) authLinks.style.display = 'none';
                        if (userGreeting) userGreeting.style.display = 'flex';
                        if (usernameDisplay) usernameDisplay.textContent = `Witaj, ${userData.username}!`;

                        if (mobileAuthLinks) mobileAuthLinks.style.display = 'none';
                        if (mobileUserGreeting) mobileUserGreeting.style.display = 'block'; 
                        if (mobileUsernameDisplay) mobileUsernameDisplay.textContent = `Witaj, ${userData.username}!`;
                        if (footerDashboardLink) footerDashboardLink.style.display = 'inline'; // Pokaż link do panelu w stopce

                        // Linki "Przeglądaj materiały" powinny działać normalnie
                        if(browseMaterialsNav) browseMaterialsNav.href = '/material_gallery.html';
                        if(browseMaterialsNavMobile) browseMaterialsNavMobile.href = '/material_gallery.html';
                        if(browseMaterialsHeroBtn) browseMaterialsHeroBtn.href = '/material_gallery.html';

                        return true; 
                    }
                }
                // Użytkownik niezalogowany lub błąd (inny niż 401/403, które powinny przekierować)
                if (authLinks) authLinks.style.display = 'flex';
                if (userGreeting) userGreeting.style.display = 'none';
                if (mobileAuthLinks) mobileAuthLinks.style.display = 'block';
                if (mobileUserGreeting) mobileUserGreeting.style.display = 'none';
                if (footerDashboardLink) footerDashboardLink.style.display = 'none';

                // Jeśli użytkownik nie jest zalogowany, linki "Przeglądaj materiały" powinny kierować do logowania
                const loginRedirectHandler = (event) => {
                    event.preventDefault();
                    showModal('Wymagane Logowanie', 'Aby przeglądać materiały, musisz się najpierw zalogować lub zarejestrować.');
                    // Opcjonalnie: setTimeout(() => { window.location.href = '/login.html'; }, 3000);
                };

                if(browseMaterialsNav) {
                    browseMaterialsNav.href = '/login.html'; // Zmień href
                    // Można też dodać event listener, jeśli chcemy modal zamiast bezpośredniego przekierowania
                    // browseMaterialsNav.addEventListener('click', loginRedirectHandler);
                }
                if(browseMaterialsNavMobile) {
                     browseMaterialsNavMobile.href = '/login.html';
                    // browseMaterialsNavMobile.addEventListener('click', loginRedirectHandler);
                }
                if(browseMaterialsHeroBtn) {
                    browseMaterialsHeroBtn.href = '/login.html';
                    // browseMaterialsHeroBtn.addEventListener('click', loginRedirectHandler);
                }


                return false; 

            } catch (error) {
                console.warn('Nie udało się sprawdzić statusu użytkownika (może być niezalogowany lub błąd serwera):', error);
                if (authLinks) authLinks.style.display = 'flex';
                if (userGreeting) userGreeting.style.display = 'none';
                if (mobileAuthLinks) mobileAuthLinks.style.display = 'block';
                if (mobileUserGreeting) mobileUserGreeting.style.display = 'none';
                if (footerDashboardLink) footerDashboardLink.style.display = 'none';
                return false; 
            }
        }

        function handleLogout() {
            fetch('/logout', { method: 'GET', credentials: 'include' })
                .then(response => {
                    if (response.ok && response.redirected) {
                        window.location.href = response.url; // Przekieruj na stronę wskazaną przez serwer (powinna być '/')
                    } else {
                        // Jeśli coś poszło nie tak, np. serwer nie przekierował
                        window.location.href = '/'; // Awaryjne przekierowanie
                    }
                })
                .catch(error => {
                    console.error('Błąd podczas wylogowywania:', error);
                    showModal('Błąd', 'Wystąpił problem podczas wylogowywania.');
                    window.location.href = '/'; // Awaryjne przekierowanie
                });
        }

        if (logoutButtonDesktop) {
            logoutButtonDesktop.addEventListener('click', handleLogout);
        }
        if (logoutButtonMobile) {
            logoutButtonMobile.addEventListener('click', handleLogout);
        }
        
        // Uruchomienie funkcji po załadowaniu DOM
        document.addEventListener('DOMContentLoaded', () => {
            // Nie ma już fetchAndDisplayMaterials() na tej stronie
            checkUserStatusAndUpdateUI();
            handleScrollAnimation(); // Upewnij się, że animacje są inicjowane
        });

    </script>
</body>
</html>